<h1>
    <center> 网络安全实验报告</center>
</h1>

## 实验目的

掌握随机函数的使用，掌握散列函数，加解密函数的使用。包格式与发包顺序可以等同于协议的三要素。掌握程序与数据库的连接。



## 实验内容

### 认证流程

1. 客户端输入用户名和密码后进行md5加密形成hash1，生成随机认证码后与hash1进行md5加密生成hash2
2. 客户端与服务器端进行握手，成功后将hash2，用户名，认证码发送给服务器端。
3. 服务器端认证完成并收到客户端数据后，用本地数据库的数据计算hash2，进行对比，如相同，随机生成认证码并用aes-128-ecb非填充方式加密后，发送给客户端
4. 客户端收到加密认证码后，解密并存入文件和显示在窗口。



### 代码关系

- 服务器端：

  - sign_in.c:

    > 注册新用户，添加其用户名和散列值到数据库

  - server.cpp:

    >认证服务器

- 客户端： 使用nodejs的electron框架实现

  - index.js: 主进程
  - hello.html: 渲染进程

> ps: 客户端运行需要node环境，npm run test

### 数据库结构

一张表，两个列，一列是用户名；一列是用户名和密码的md5，以16进制字符串方式存储。

### 交互状态

1. c$\rightarrow$s: 天王盖地虎
2. s$\rightarrow$c: 宝塔镇河妖
3. c$\rightarrow$s: 认证
4. s$\rightarrow$c: 好滴
5. c$\rightarrow$s: data
6. s$\rightarrow$c: data

over

## 实验结果

![](.\pics\1.png)



## 实验总结

因为对node的crypto模块的不熟悉，遇到了难以言喻的bug——就是无法正常解密服务器端加密的数据，后来经过艰苦卓绝的debug（面向搜索引擎编程），得知该模块默认使用填充方式加解密，而我用c的openssl库时并没有填充。